<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<title>Home controller</title>

    <link href="/css/ui-darkness/jquery-ui.css" rel="stylesheet" type="text/css"/>
  
    <script type="text/javascript" src="/synapse/synapse.js"></script>
    <script type="text/javascript" src="arduino.js"></script>

	<style>
        .prototype
        {
            display: none;
        }
 	</style>

    <script>
        $(document).ready(function(){

            //////////////////////// node.ping
            var pings={};
            $('.prototype[event="node.ping"]')
                .on("widget_update",function(e, msg)
                {
                    clearTimeout(pings[msg["node"]]);
                    $(this).text("node "+msg["node"]);
                    var last_ping=serverTime()-msg["time"];
                    if (last_ping>65)
                    {
                        $(this).css('background-image', 'url("arduino/offline.png")');
                    }
                    else
                    {
                        $(this).css('background-image', 'url("arduino/online.png")');
                        //show offline when we dont receive the next ping in time
                        setTimeout(function()
                        {
                            $(this).css('background-image', 'url("arduino/offline.png")');

                        }, 65000-last_ping*1000);
                    }
                });
        });
    </script>
</head>


<body 
    class="ui-widget ui-widget-content" 
    style="
        font-size: 14px;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background-color: #000000"
>

<div class='prototype' event='node.ping' style='
    padding-left: 1em;
    background-repeat: no-repeat;
'>
</div>



</body>
</html>

