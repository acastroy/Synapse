<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- (C)edwin@datux.nl - released under GPL -->
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<title>internetpapier.nl - BETA</title>

	<script src="svg.js"></script>
	<script type="text/javascript" src="synapse.js"></script>
	<script type="text/javascript" src="jquery.url.js"></script>
	<script type="text/javascript">

		function Cpoint(x,y)
		{
			this.x=x;
			this.y=y;
	
			this.copy=function(point)
			{
				this.x=point.x;
				this.y=point.y;
			}
			
		}
 	
		var mouseInterval=50; //max update inteval in mS (can be higer if mouseMax is exceeded)
		var mouseMax=50; //max mouse pixel offset before sending (regardless of update interval)
	
		var mousePoint=new Cpoint(); //current mouse position
		var mousePointStart=new Cpoint(); //mouse position at start of current operation
	
		//mouse info sending to server:
		var mouseSendPoint=new Cpoint(); //last mousepoint sent to server
		var mouseSendTime=0; //last time the mousePosition was anaylsed by updateGameField
	
		var mouseMode="";		
		var mouseTarget="";
		var mouseTargetHigh="";
		var mouseHighlight=0;

		//temporary local objects counter
		var tempCount=0;
		
		var currentObjectId=0;
		var paperModId=0;
	
		var drawMode="l";
			
		//incremental draw stuff
		var clientId=0;
		var clients=new Array(); 
		var ourId=0;

		var drawing;
		var drawingInsert;
		var drawingHtml;
		

		
		//filter dangerous stuff from user input.
		//NOTE: do this when you receive the data back from the server, not when sending to it!
		function filterInput(s)
		{
			return(s.replace(/</g,"&lt;").replace(/>/g,"&gt;"));
		}

		//calculate browser coordinates to server coordinates
		function toServer(x,y)
		{
			
			//return ( { "x":x, "y":y } );
			return ({
				"x":Math.round((x * 10000) / $("#drawing").width()),
				"y":Math.round((y * 10000) / $("#drawing").height())
			});
		}
	

		
		function paperLink(id,text)
		{
			return ("<a class='paperLink' href='paper.html?id="+id+"'>"+text+"</a>");
		}

		function addChat(html)
		{
			$('#chatList').append(html);

			//scroll to end
			var objDiv = document.getElementById("chatList");
			objDiv.scrollTop = objDiv.scrollHeight;
		}


		//highlight an object
		function highlight(id)
		{
			//add highlite, if we can find the element:
			var element=document.getElementById(id);
			if (element!=null)
			{
				element.setAttribute('stroke-opacity','0.5');
				element.setAttribute('fill-opacity','0.5');
			}
		}

		function unhighlight(id)
		{
			//remove highlite, if we can find the element:
			var element=document.getElementById(id);
			if (element!=null)
			{
				element.removeAttribute('stroke-opacity');
				element.removeAttribute('fill-opacity');
			}
		}
		
		/*** Drawing protocol
		
		Drawing stuff is done with paper_clientDraw.
		The message is translated to a paper_serverDraw and forwarded to all clients.
		The message is normally not echoed back, unless requested
		
		### Common parameters
		src:		added by server. session id that send the message
		noreplay:	dont relay the command to other clients

		### Drawing commands and parameters:
		cmd:		command to do:
						update: create/modify element 
						delete: remove element
						refresh: 	let the server resend an update cmd with all info about the element, to this client. 
						ready: when doing a full redraw on join, this indicates the drawing is "ready"					
					
		Only for updates with new (not yet existing) objects:
		element:		svg element type (e.g. circle,rect,polyline)
		
		update parameters:
		add:    	svg attributes to append data to (used for polylines)
		set:		svg attributes to set/replace


		update/delete parameters:		
		id:			element id for update/delete. 
					if set to 'new' with an update, the server will create a new element and replace it with its id.
					if not set by with an update/refresh, the id is replaced by id used in the last 'update' for this client. 

		beforeId:   set by server to the id of the element this element should be inserted before. this is important to keep the order of all the elements correct.
		normally only set when requesting a refresh.

		#### Cursor indication
		cursor:     Cursor and name information: x,y,clientName

		### Chat
		chat:		Chat text: text, clientName
				
		'
		 */


		function draw(msg)
		{
			var suspendID = drawing.suspendRedraw(250);
			 
			//create/update object
			if (msg["cmd"]=="update")
			{
				if (msg["id"]!=null)
				{
					var element=document.getElementById(msg["id"]);
					//element not found? 
					if (element==null)
					{
						//create new element
						var element = document.createElementNS(svgns, msg["element"]);
						element.setAttribute('id', msg["id"]);
	
						//insert before existing or just append?
						var beforeElement=null;
						if (msg["beforeId"]!=null)
							beforeElement=document.getElementById(msg["beforeId"]);
	
						//NOTE: svgweb is buggy and doesnt support insertbefore with a null element
						if (beforeElement==null)
							drawing.insertBefore(element, drawingInsert);							
						else
							drawing.insertBefore(element, beforeElement);							
					}
					
					//we need to add/set attributes?
					if (msg["add"] || msg["set"])
					{
						for (var attrName in msg["set"])
						{
							element.setAttribute(attrName, msg["set"][attrName]);
						}							
	
						for (var attrName in msg["add"])
						{
							if (element.getAttribute(attrName)!=null)
							{
								element.setAttribute(attrName, element.getAttribute(attrName)+msg["add"][attrName]);
							}
							else
								element.setAttribute(attrName, msg["add"][attrName]);
						}
					}
				}
				
				//remove any temporary objects
				if (msg["tempId"]!=null)
				{
					var element=document.getElementById(msg["tempId"]);
					if (element!=null)
					{
						drawing.removeChild(element);
					}
				}		

			}
			//delete object
			else if (msg["cmd"]=="delete")
			{
				//console.log("DEL"+msg["id"]);
				var element=document.getElementById(msg["id"]);
				if (element!=null)
				{
					drawing.removeChild(element);
				}	
			}
			else if (msg["cmd"]=="ready")
			{
				//NOTE: this also works around a weird chromuim refresh bug.
				$("#loading").hide();
			}			

			//update cursor?
			if (msg["cursor"]!=null && msg["src"]!=ourId)
			{
				var cursor=document.getElementById('cursor'+msg["src"]);
				if (cursor==null)
				{
					//create a group for this client's cursor
					cursor = document.createElementNS(svgns, 'g');
					cursor.setAttribute('id', 'cursor'+msg["src"]);
					cursor.setAttribute('stroke', '#000000');
					cursor.setAttribute('stroke-width', '10');
					drawing.appendChild(cursor);

					//add drawing to the cursor group
					var e = document.createElementNS(svgns, 'line');
					e.setAttribute('x1', '-200');
					e.setAttribute('x2', '+200');
					e.setAttribute('y1', '0');
					e.setAttribute('y2', '0');
					cursor.appendChild(e);					

					var e = document.createElementNS(svgns, 'line');
					e.setAttribute('x1', '0');
					e.setAttribute('x2', '0');
					e.setAttribute('y1', '-200');
					e.setAttribute('y2', '+200');
					cursor.appendChild(e);					
			
				}

				//update cursor position?
				if (msg["cursor"]["x"]!=null)
				{
					cursor.setAttribute('transform', 'translate('+msg["cursor"]["x"]+','+msg["cursor"]["y"]+')');
				}
					
				//update cursor clientname?
				if (msg["cursor"]["clientName"]!=null)
				{
					//we need to re-add this node on every update..
					var oldE=document.getElementById('clientName'+msg["src"]);

					if (oldE!=null)
						cursor.removeChild(oldE);
					
					//create text element
					var e = document.createElementNS(svgns, 'text');
					e.setAttribute('id', 'clientName'+msg["src"]);
					e.setAttribute('x', '0');
					e.setAttribute('y', '300');
					e.setAttribute('font-size','200');
					e.setAttribute('font-weight','bold');
					e.setAttribute('stroke','#000000');
					e.setAttribute('fill','#ffffff');
					cursor.appendChild(e);					

					//add the actual text
					var textNode = document.createTextNode(msg["cursor"]["clientName"], true);
					e.appendChild(textNode);
				
				}

			}

			//update chat?
			if (msg["chat"] != null)
			{
				addChat(
					"<b>"+filterInput(msg["chat"]["clientName"])+"</b> "+filterInput(msg["chat"]["text"])+"<br>"
				);
			}

			drawing.unsuspendRedraw(suspendID);
		}

		//someone left, remove their cursor and stuff
		synapse_register("object_Left",function(msg_src, msg_dst, msg_event, msg)
		{
			var cursor=document.getElementById('cursor'+msg["clientId"]);
			if (cursor!=null)
			{
				drawing.removeChild(cursor);
			}
		
		});


		//received a drawing command from the server
		synapse_register("paper_ServerDraw",function(msg_src, msg_dst, msg_event, msg)
		{
			draw(msg);
		});


		//send drawing msg to server 
		//note: you need to specifiy server coordinates instead of browser coordinates here.		
		function sendDraw(msg)
		{
			//only if we're joined to something
			if (!currentObjectId)
				return;
			
			//send it to server
			send(paperModId,"paper_ClientDraw", msg);

			//the server doesnt echo our stuff back, so we can handle it locally without lag
			//call the draw function and emulate the server by adding some stuff
			msg["src"]=ourId;
			if (msg["id"]==null || msg["id"]=="new")
				msg["id"]="temp"+tempCount;
			draw(msg);
		}


		//user moves mouse		
		function mouseMove(force)
		{
			
			//mouse throttling function, to prevent too many updates per second
			//no change?
			if (force!=true && mousePoint.x==mouseSendPoint.x && mousePoint.y==mouseSendPoint.y)
				return;

			currentTime=new Date().getTime();

			//send updates at a max fps, or more when the mouse moves fast
			if (	force==true ||
					(currentTime-mouseSendTime>=mouseInterval) || 
					Math.abs(mousePoint.x-mouseSendPoint.x)> mouseMax ||
					Math.abs(mousePoint.y-mouseSendPoint.y)> mouseMax 
			)	
			{ 
				//highlighting target changed?
				if (mouseHighlight && mouseTarget!=mouseTargetHigh)
				{
					//remove old highlite (if any)
					unhighlight(mouseTargetHigh);
					//valid new target?
					if (mouseTarget == parseInt(mouseTarget))
					{
						highlight(mouseTarget);
					}
					mouseTargetHigh=mouseTarget;
				}

				
				var c=toServer(mousePoint.x,mousePoint.y);
				var msg={};

				//cursor
				msg['cursor']=c;
				
				if (mouseMode=="line")
				{
					msg['cmd']='update';
					msg['add']={
						'points': ' '+c.x+','+c.y
					}
				}
				else if (mouseMode=="rect")
				{
					var cStart=toServer(mousePointStart.x,mousePointStart.y);
					var w=c.x-cStart.x;
					var h=c.y-cStart.y;
					if (w<10)
						w=10;
					if (h<10)
						h=10;
					
					msg['cmd']='update';
					msg['set']={
						'width': w,
						'height': h					
					}
				}
				else if (mouseMode=="circle")
				{
					var cStart=toServer(mousePointStart.x,mousePointStart.y);
					var rx=Math.abs(c.x-cStart.x);
					var ry=Math.abs(c.y-cStart.y);
					//var r=Math.sqrt(Math.pow(xoffset,2)+Math.pow(yoffset,2));
					
					if (rx<100)
						rx=10;
					if (ry<100)
						ry=10;
					
					msg['cmd']='update';
					msg['set']={
						'rx': rx,
						'ry': ry
					}
				}
				else if (mouseMode=="delete")
				{ 
					//only allow numeric id's to be deleted. otherwise you could delete cursors and stuff as well :P
					if (mouseTarget == parseInt(mouseTarget))
					{
						msg['cmd']='delete';
						msg['id']=mouseTarget;
					}				
				}
				else if (mouseMode=="move")
				{
					var cStart=toServer(mousePointStart.x,mousePointStart.y);
					var dx=(c.x-cStart.x);
					var dy=(c.y-cStart.y);
					
					msg['cmd']='update';
					msg['id']=mouseTargetStart;
					msg['set']={
						'transform':'translate('+dx+','+dy+')'
					}
				}

				sendDraw(msg);

				mouseSendPoint.x=mousePoint.x;
				mouseSendPoint.y=mousePoint.y;
				mouseSendTime=currentTime;
			}
		}	

		//user starts a mouse operation (clicks somewhere)
		function mouseStart(m)
		{
			if (mousePoint.x==null || mousePoint.y==null)
				return;
			tempCount++;
			mouseMode=$('#modes .selected').attr("value");
			mouseTargetStart=mouseTarget;
			mousePointStart.x=mousePoint.x;
			mousePointStart.y=mousePoint.y;

			//enable filling?
			var fill='none';
			if ($('#modes .selected').attr("fill")==1)
				fill=$('#colors .selected').attr("value");
	
			//do the action:
			if (mouseMode=="line")
			{
				
				sendDraw({
					'cmd'		:'update',
					'id'		:'new',
					'element'	:'polyline',
					'set'		: {
						'fill'				: fill,
						'stroke'			: $('#colors .selected').attr("value"),
						'stroke-width'		: $('#widths .selected').attr("value"),
						'stroke-dasharray'	: $('#styles .selected').attr("value")
					}
				});
			}
			else if (mouseMode=="rect")
			{
				var c=toServer(mousePoint.x,mousePoint.y);

				sendDraw({
					'cmd'		:'update',
					'id'		:'new',
					'element'	:'rect',
					'set'		: {
						'fill'				: fill,
						'stroke'			: $('#colors .selected').attr("value"),
						'stroke-width'		: $('#widths .selected').attr("value"),
						'stroke-dasharray'	: $('#styles .selected').attr("value"),
						'x'					: c.x, 
						'y'					: c.y
					}
				});
			}
			else if (mouseMode=="circle")
			{
				var c=toServer(mousePoint.x,mousePoint.y);

				sendDraw({
					'cmd'		:'update',
					'id'		:'new',
					'element'	:'ellipse',
					'set'		: {
						'fill'				: fill,
						'stroke'			: $('#colors .selected').attr("value"),
						'stroke-width'		: $('#widths .selected').attr("value"),
						'stroke-dasharray'	: $('#styles .selected').attr("value"),
						'cx'				: c.x, 
						'cy'				: c.y
					}
				});
			}

			//force a mouse move
			mouseMove(true);
		}

		//user ends operation (leaves or mouse up)
		function mouseEnd(m)
		{
			if (mouseMode!="")
			{
				mouseMode="";
				sendDraw({
					'cmd'		:'refresh',
					'norelay'	:1,
					'tempId'	:'temp'+tempCount
				});				
			};
			unhighlight(mouseTargetHigh);
			mouseTargetHigh="";
		}
	    
	    synapse_register("module_SessionStart",function(msg_src, msg_dst, msg_event, msg)
 		{
			ourId=msg_dst;

			/// figure out client name
			var clientName=$.readCookie('clientName', { path:"/" } );
			if (!clientName)
			{
				//make up a "random" guest name
				clientName="User "+msg_dst;
			}
			
			//set the name input field
			$("#clientName").val(clientName);
			

			
			/// JAVA SCRIPT EVENT HANDLERS

			//user changes name
			$("#clientName").keyup(function(m)
			{
				$.setCookie('clientName', $("#clientName").val(), { duration:365, path:"/" });
				sendDraw({
					'cursor':{
						'clientName':$("#clientName").val()
					}
				});
					
			});

			//user presses enter in chatbox:
			$("#chatInput").keydown(function(m)
			{
				if (m.keyCode==13)
				{
					sendDraw( {
						'chat':{
							'clientName'	:$("#clientName").val(),
							'text'			:$("#chatInput").val()
						}
					});
					$("#chatInput").val("");						
				}					
	 		});

			
			//a tool is clicked
			$(".tool").click(function(m)
			{
				//unselect all tools in that group
				$(this).parent().children(".tool").removeClass('selected');
				//select this one
				$(this).addClass('selected');

				//switch highlite mode on?
				if ($(this).attr('highlight')=='1')
					mouseHighlight=1;

				//switch highlite mode off?
				if ($(this).attr('highlight')=='0')
					mouseHighlight=0;
				
				$("#chatInput").focus();
			});

			//clear button
			$("#clear").click(function(m)
			{
				//a clear actually creates a new drawing so the old one is preserved
				send(0,"paper_Create", { "moveClients":1 } );
			});



			//wait until svgloading is complete
		    window.addEventListener('SVGLoad', function() {
			    
				//create a svg node and assign it to global variable "drawing".
				drawing = document.createElementNS(svgns, "svg");

				//set some basic attributes
				drawing.setAttribute("version", "1.2");
				drawing.setAttribute("baseProfile", "tiny");
				drawing.setAttribute("viewBox", "0 0 10000 10000");
				drawing.setAttribute("id","bg");
				drawing.setAttribute("preserveAspectRatio", "none");

				//default settings
				drawing.setAttribute("stroke-linecap","round");
				drawing.setAttribute("stroke-linejoin","round");

//				drawing.setAttribute("color-rendering","optimizeSpeed");
//				drawing.setAttribute("shape-rendering","optimizeSpeed");
//				drawing.setAttribute("text-rendering","optimizeSpeed");
//				drawing.setAttribute("image-rendering","optimizeSpeed");
				

				//wait until rootobject is created
				drawing.addEventListener('SVGLoad', function(evt) 
				{
					//when its in flashmode, the references change somehow, so re-get it:				
					drawing=document.getElementsByTagNameNS(svgns, 'svg')[0];

					//add a node that indicates where drawing elements should be inserted before
					drawingInsert = document.createElementNS(svgns, 'g');
					drawing.appendChild(drawingInsert);
					
					//set mouse move event
					//NOTE: pageX is not set when using chromium in flash mode? when we use jquery mousemove its ok ,but then we cant see 
					//which object is hovered over.
					drawing.addEventListener('mousemove', function(m) 
					{
						mouseTarget=m.target.id;
						//work around SVG bug http://code.google.com/p/svgweb/issues/detail?id=244
						if(drawing.fake)
						{
							//flash workaround
							mousePoint.x=m.clientX;
							mousePoint.y=m.clientY;
						} 
						else 
						{
							//normal
							mousePoint.x=m.clientX-$("#drawing").offset().left;
							mousePoint.y=m.clientY-$("#drawing").offset().top ;
						}
													
						mouseMove(false);
					});

					//set mouse click event
					drawing.addEventListener('mousedown', function(m)
					{
						if (m.preventDefault)
							m.preventDefault();
						else
							m.returnValue=false;


						mouseStart(m);

						return false;
					});

					//set mouse up event
					drawing.addEventListener('mouseup', mouseEnd)
							
					//set mouse leave event
					//(doesnt work with addeventlistener!)
					$("#drawing").mouseleave(mouseEnd);
						
					/// start mouse update engine
					window.setInterval(function() { mouseMove(false) }, mouseInterval);


					//join the specified paper
					send(0,"paper_Join", {
						"objectId":jQuery.url.param("id")
					});
							

				});
				
				//add drawing rootobject to html container
				drawingHtml = document.getElementById("drawing");
				svgweb.appendChild(drawing, drawingHtml);
		     }, false);

		
 		});

		function reset()
		{
			$('#clientList').empty();
			$('#chatList').empty();
			$("#chatInput").val("");
			$("#chatInput").focus();
			
			
			//select default tools
			$(".tool").removeClass('selected');
			$(".defaultTool").addClass('selected');

		}

	    
		//we've joined a object
 		synapse_register("object_Joined",function(msg_src, msg_dst, msg_event, msg)
		{
			//doesnt the url match?
			if (jQuery.url.param("id")!=msg["objectId"])
				document.location="paper.html?id="+msg["objectId"];
 			
			//we've joined a object, from now on draw on it.
			currentObjectId=msg["objectId"];
			paperModId=msg_src;
			$("#objectId").html(msg["objectId"]);
			//TODO:dynamic svg-path
			$("#svgURL").attr("href","p/"+msg["objectId"]+".svg");
			$("#pngURLsmall").attr("href","p/"+msg["objectId"]+".small.png");
			$("#pngURLmedium").attr("href","p/"+msg["objectId"]+".medium.png");
			$("#pngURLlarge").attr("href","p/"+msg["objectId"]+".large.png");
			
			//reset stuff
			reset();

			//tell people who we are and set random mouse position
			sendDraw({
				'cursor':{
					'clientName':$("#clientName").val(),
					'x':Math.round(9000*Math.random())+1000,
					'y':Math.round(9000*Math.random())+1000
				}
			});
		});
 		
 				

 		

	




	</script>

	<style>
		body 
		{
			margin:0;
			padding:0;
			height:100%;
		} 

		.client
		{
			margin-top:2px;
			padding:5px;
			border-bottom-style:dashed;
			border-bottom-color:#aaaaaa;
		}

		#objectManager
		{
			position:absolute; 
			left:0;
			top: 0;
			width: 16em;
			bottom:0;
			border-style:none;
		}

		#drawing
		{
			position:absolute; 
			left:16em;
			top: 0;
			right: 0;
			bottom:0;
			cursor:crosshair;
			margin: 0;
			padding: 0;
		}

		
		
		
		#loading
		{
			position:absolute;
			left:0;
			right:0;
			top:0;
			bottom:0;
			background-fill:none;
			text-align:center;
			color: red;
			font-size: 1000%;
		}
		
		#colors
		{
			
		}
		
		.tool
		{
			width:2em;
			max-width:2em;
			height:2em;
			max-height:2em;
			border-width:2px;
			border-style:solid;
			cursor:pointer;
			display:inline-block;
			border-color:#ffffff;
		}
		
		.selected
		{
			border-color:#aaaaaa;
		}
		
		img
		{
			border:0;
			margin:0;
			padding:0;
			display:inline;
		}
		
		#chatList
		{
			max-height:8em;
			overflow-y:scroll;
		}
		
		#clientList
		{
			max-height:8em;
			overflow-y:auto;		
		}
		
		.paperLink
		{
			background-color: yellow;
			text-decoration: none;
			display:block;
		}
	</style>

</head>


<body class='ui-widget'>
	<div class='ui-widget-content' id='objectManager'>

		<div class='ui-widget-header'>Delen met anderen:</div>

		Papier nummer: <span id='objectId'></span><br>
		<a id='svgURL' target='_blank'>SVG link</a>
		<br>
		PNG: 
		<a id='pngURLsmall' target='_blank'>small</a>
		<a id='pngURLmedium' target='_blank'>medium</a>
		<a id='pngURLlarge' target='_blank'>large</a>

		<br>
		
		<br>

		<input type='submit' value='Nieuw' id='clear'>

		<div class='ui-widget-header'>Gereedschap:</div>


		<div id='colors'>
			<div class='tool color defaultTool' style='background-color:#000000' value='#000000'>&nbsp;</div>
			<div class='tool color ' style='background-color:#0000ff' value='#0000ff'>&nbsp;</div>
			<div class='tool color ' style='background-color:#00ff00' value='#00ff00'>&nbsp;</div>
			<div class='tool color ' style='background-color:#00ffff' value='#00ffff'>&nbsp;</div>
			<div class='tool color ' style='background-color:#FF8040' value='#FF8040'>&nbsp;</div>
			<div class='tool color ' style='background-color:#ffffff' value='#ffffff'>&nbsp;</div>
			<br>
			<div class='tool color' style='background-color:#ff0000' value='#ff0000'>&nbsp;</div>
			<div class='tool color' style='background-color:#ff00ff' value='#ff00ff'>&nbsp;</div>
			<div class='tool color' style='background-color:#ffff00' value='#ffff00'>&nbsp;</div>
			<div class='tool color' style='background-color:#999999' value='#999999'>&nbsp;</div>
			<div class='tool color' style='background-color:#804000' value='#804000'>&nbsp;</div>
			<div class='tool color' style='background-color:#F87217' value='#F87217'>&nbsp;</div>
			<br>
		</div>		

		<div id='widths'>
			<div class='tool' value='10'><img src='img/pen1.png' style='width:1em' ></div>
			<div class='tool' value='20'><img src='img/pen1.png' style='width:1.2em'></div>
			<div class='tool' value='30'><img src='img/pen1.png' style='width:1.3em'></div>
			<div class='tool defaultTool' value='40'><img src='img/pen1.png' style='width:1.4em' ></div>
			<br>
			<div class='tool' value='100'><img src='img/pen2.png' style='width:1em' ></div>
			<div class='tool' value='200'><img src='img/pen2.png' style='width:1.2em' ></div>
			<div class='tool' value='300'><img src='img/pen2.png' style='width:1.3em' ></div>
			<div class='tool' value='400'><img src='img/pen2.png' style='width:1.4em' ></div>		
		</div>

		<div id='modes'>
			<div class='tool defaultTool' value='line' highlight=0>lijn</div>
			<div class='tool' value='line' fill=1 highlight=0>LIJN</div>
			<div class='tool' value='delete' highlight='1'>[gum]</div>
			<div class='tool' value='move' highlight='1'>[move]</div>
			<br></br>
			<div class='tool' value='rect' highlight=0>vierk</div>
			<div class='tool' value='rect' fill=1 highlight=0>VIERK</div>
			<br></br>
			<div class='tool' value='circle' highlight=0>cirkel</div>
			<div class='tool' value='circle' fill=1 highlight=0>CIRKEL</div>
		</div>

		<div id='styles'>
			<div class='tool defaultTool' value='none'>norm</div>
			<div class='tool' value='20,200'>stip</div>
			<div class='tool' value='200,200'>streep</div>
		</div>


 		<div class='ui-widget-header'>Chat:</div>
		Naam: <input id='clientName' type='text' value='' size=10>
		<div id='chatList'></div>
		<input id='chatInput' type='text' value='' >
<!-- 


		<div class='ui-widget-header'>Andere mensen:</div>
		<div id='clientList'></div>
-->

	</div>


	<div id='loading' >Loading...</div>


	<div id='drawing'></div>		


	
</body>
</html>